以文字檔為例，現今的文字檔常見的是以 [[Character Encoding & Decoding|utf-8]] 編碼，一個 character 會佔用到 2 bytes 甚至 3 bytes，然而一個 ASCII character 的大小其實只有 1 byte，因此一個 utf-8 編碼文字檔中，ASCII character 的開頭會有很多個 `0`，這樣其實很浪費空間。

而檔案壓縮其實就是透過想辦法把這些 **leading zero** 的空間釋放出來給需要的資料用，進而達到縮小檔案大小的效果。你可以想像一個喝完的鋁罐或鋁箔包，中間是空的，壓扁後體積就縮小了。

Data Compression (Source Coding, or Bit-Rate Reduction) 的演算法有很多（詳見 [[Data Compression Algorithms]]），因此也有很多不同的壓縮檔案用的指令。

壓縮過的檔案無法直接使用，作業系統會不知道如何讀取／寫入／執行它們，因此每一種壓縮方式都會有對應的「解壓縮」，在 Linux 中，不同的壓縮方式壓出來的 file extension 不同，但 file extension 並不會決定檔案本身的性質，僅是方便人類辨識而已。

常見的壓縮方式及 file extension 對應如下：

|指令|file extension|功能|
|---|---|---|
|`compress`|`*.Z`|壓縮|
|`gzip`|`*.gz`|壓縮|
|`bzip2`|`*.bz2`|壓縮|
|`zip`|`*.zip`|壓縮|
|`rar`|`*.rar`|壓縮|

上述這些壓縮檔案的指令，一次都只能對單一個檔案進行壓縮，無法一次壓縮多個檔案，也無法壓縮一個 directory，此時我們就需要「打包」，有關打包的指令如下：

|指令|file extension|功能|
|---|---|---|
|`tar`|`*.tar`|打包|
|`tar` + `gzip`|`*.tar.gz`|打包＋壓縮|

# `compress`

### 壓縮

```bash
compress [<OPTIONS>] <FILE>
```

`compress` 使用的是 modified Lempel-Ziv Algorithm，壓縮出來的檔案會自動帶上 `.Z` 做為 file extension。

`compress` 壓縮出來的檔案會直接取代掉原本的檔案，換句話說，原本的檔案壓完後就消失了。

> [!Note]
>預設情況下，使用 `compress` 壓縮檔案時，如果系統發現一個檔案被壓縮後的大小不減反增，則會自動放棄壓縮。

**Options**

- `-c`：直接 stdout 壓縮後的結果，不將壓縮結果存進檔案
- `-f`：強制壓縮，就算壓縮完後檔案變大也照壓
- `-v`：壓完後 stdout 檔案大小的變化百分比
- `-d`：解壓縮

### 解壓縮

解壓縮可以使用 `compress -d` 或 `uncompress`，使用前者可以不用寫出 file extension (`.Z`)；但使用後者則一定要完整地寫出整個檔案名稱：

```bash
compress -d <FILE_COMPRESSED>

# or

uncompress <FILE_COMPRESSED>
```

或者可以使用 `zcat` 讀取並 stdout 被壓縮的檔案的原文：

```bash
zcat <FILE_COMPRESSED>
```

其中 `FILE_COMPRESSED` 不用加副檔名。

> [!Note]
> `zcat` 只能解讀 file extension 為 `.Z` 的檔案，但並不一定要是 `compress` 壓出來的，也就是說你可以用其他指令壓縮檔案然後把 file extension 改為 `.Z`，這樣就可以用 `zcat` 解讀了。

# `gzip`

`gzip` 的 g 代表的是 [[GNU]]，`gzip` 是比 `compress` 新一代的指令。

### 壓縮

```bash
gzip [<OPTIONS>] <FILE>
```

`gzip` 使用的是 Lempel-Ziv Algorithm，壓縮出來的檔案會預設是帶上 `.gz` 做為 file extension，但可以透過 option 更改。另外，`gzip` 壓縮出來的檔案也會直接取代掉原本的檔案。

**Options**

- `-1` ~ `-9`：數字越小代表壓縮速度越快，但壓縮效果越差；反之，數字越大則代表壓縮速度越慢，但壓縮效果越顯著，預設是 `-6`。
- `-c`：直接 stdout 壓縮後的結果，不將壓縮結果存進檔案
- `-d`：解壓縮
- `-k`：保留原檔案，將壓縮過的檔案另存
- `-S <SUFFIX>`：捨定壓出來的檔案的 file extension
- `-v`：將壓縮的結果 stdout，包括壓縮比等

### 解壓縮

解壓縮可以使用 `gzip -d` 或 `gunzip`

```bash
gzip -d <FILE_COMPRESSED>

# or

gunzip <FILE_COMPRESSED>
```

# 參考資料

- <https://linux.vbird.org/linux_basic/mandrake9/0240tarcompress.php>
